<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>AFK Mode ‚Äî Earn while you‚Äôre AFK üí§</title>
  
  <script src="https://unpkg.com/@solana/web3.js@latest/lib/index.iife.js"></script>
  <script src="https://unpkg.com/@solana/spl-token@latest/lib/index.iife.js"></script>

  <script src="https://unpkg.com/@solana/wallet-adapter-base@latest/lib/index.iife.js"></script>
  <script src="https://unpkg.com/@solana/wallet-adapter-wallets@latest/lib/index.iife.js"></script>
  <script src="https://unpkg.com/@solana/wallet-adapter-react-ui/styles.css"></script>

  <script>
    const BACKEND_URL = "https://api.afkcoin.xyz";
  </script>
  <style>
    /* (Estilos sin cambios, omitidos por brevedad) */
    :root{
      --bg:#0b1115;--panel:#111a20;--accent:#39ff88;--accent2:#6be3ff;--muted:#8aa3b4;--danger:#ff5773;
    }
    html,body{height:100%;margin:0;background:radial-gradient(1200px 800px at 20% -10%, #0f1b24, #0b1115 40%), #0b1115;color:#e9f1f7;font-family:Inter,system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif}
    .wrap{max-width:980px;margin:32px auto;padding:24px}
    .card{background:linear-gradient(180deg,rgba(255,255,255,.02),rgba(255,255,255,.00));border:1px solid rgba(255,255,255,.08);border-radius:20px;box-shadow:0 10px 40px rgba(0,0,0,.35);padding:24px}
    h1{margin:0 0 8px;font-size:clamp(26px,4vw,40px);letter-spacing:.5px}
    .grid{display:grid;grid-template-columns:1.2fr .8fr;gap:20px;margin-top:18px}
    @media (max-width:900px){.grid{grid-template-columns:1fr}}
    .stat{background:rgba(0,0,0,.25);border:1px solid rgba(255,255,255,.06);border-radius:16px;padding:16px}
    .stat h3{margin:0 0 6px;font-size:1rem;color:var(--muted)}
    .big{font-size:clamp(28px,6vw,48px);font-weight:800;letter-spacing:.5px}
    .row{display:flex;gap:12px;flex-wrap:wrap;align-items:center}
    .btn{appearance:none;border:0;border-radius:12px;padding:12px 16px;font-weight:700;cursor:pointer;transition:transform .1s ease}
    .btn:active{transform:scale(.95)}
    .btn:disabled{cursor:not-allowed;opacity:.5}
    .btn-primary{background:linear-gradient(90deg,var(--accent),#7bffb8);color:#052012;box-shadow:0 6px 20px rgba(57,255,136,.35)}
    .btn-outline{background:transparent;border:1px solid rgba(255,255,255,.18);color:#e9f1f7}
    .btn-ghost{background:transparent;color:var(--muted)}
    .pill{display:inline-block;border:1px dashed rgba(255,255,255,.2);padding:6px 10px;border-radius:999px;color:var(--muted);font-size:.9rem}
    .neon{color:var(--accent);text-shadow:0 0 6px rgba(57,255,136,.7), 0 0 18px rgba(57,255,136,.35)}
    .log{height:200px;overflow:auto;background:#0b1217;border:1px solid rgba(255,255,255,.06);border-radius:12px;padding:12px;font-family:ui-monospace,Consolas,monospace;font-size:.9rem}
    .muted{color:var(--muted)}
    .boosters-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:16px;text-align:center;margin-top:16px}
    .booster-card{background:rgba(0,0,0,.2);border:1px solid rgba(255,255,255,.06);border-radius:16px;padding:16px}
    .booster-card h4{margin:0 0 8px;font-s

ize:1.1rem}
    .booster-card .cost{font-size:1.2rem;font-weight:700;color:var(--accent2)}
    @media(max-width:600px){.boosters-grid{grid-template-columns:1fr}}

    /* Estilos para el modal del Wallet Adapter */
    .swal2-popup { background: var(--panel) !important; color: #e9f1f7 !important; border-radius: 20px !important; border: 1px solid rgba(255,255,255,.08) !important; }
    .swal2-title { color: #e9f1f7 !important; }
    .swal2-html-container button { background: rgba(255,255,255,.05) !important; color: #e9f1f7 !important; border: 1px solid rgba(255,255,255,.1) !important; margin: 4px !important; border-radius: 8px !important; }
  </style>
</head>
<body>
  <div class="wrap">
    </div>

  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <script>
    const AFK_TOKEN_MINT_ADDRESS = '1THEbQ2K1ELPQcsgfWhbSyApMeiXhofRexvmTVFvDfX';
    const TREASURY_WALLET_ADDRESS = 'F3zY8TZ9jiCTneBkPQr1DMbyT9vgwdBUXCoZB9h4GP5G';
    const connection = new solanaWeb3.Connection('https://mainnet.rpc.solaxy.io');

    const state = { /* ... */ };
    // ... (resto de funciones de la app sin cambios) ...

    // <<< CAMBIO: L√≥gica de conexi√≥n completamente nueva usando Wallet-Adapter >>>
    let wallet;

    function initializeWalletAdapter() {
        const wallets = [
            // El adapter de Solaxy no est√° en un CDN, por lo que usaremos el de Phantom
            // como ejemplo. Solaxy deber√≠a ser detectado si sigue el est√°ndar.
            new walletAdapterWallets.PhantomWalletAdapter(),
            new walletAdapterWallets.SolflareWalletAdapter(),
        ];

        const walletAdapter = new walletAdapterBase.WalletProvider({ wallets });

        walletAdapter.on('connect', (publicKey) => {
            wallet = walletAdapter;
            handleConnection(publicKey);
        });

        walletAdapter.on('disconnect', () => {
            wallet = null;
            handleDisconnection();
        });
        
        return walletAdapter;
    }
    
    const walletAdapter = initializeWalletAdapter();

    async function connectWallet() {
        if (walletAdapter.connected) {
            await walletAdapter.disconnect();
        } else {
            // Mostrar un modal para elegir la wallet
            const walletNames = walletAdapter.wallets.map(w => w.name);
            const { value: selectedWallet } = await Swal.fire({
                title: 'Elige tu Wallet',
                input: 'select',
                inputOptions: Object.fromEntries(walletNames.map(name => [name, name])),
                inputPlaceholder: 'Selecciona una wallet',
                showCancelButton: true,
                confirmButtonText: 'Conectar',
            });

            if (selectedWallet) {
                walletAdapter.select(selectedWallet);
                await walletAdapter.connect();
            }
        }
    }

    async function handleConnection(publicKey) {
      const key = publicKey.toString();
      state.pubkey = key;
      // ... (resto de la l√≥gica de handleConnection)
    }

    function handleDisconnection() {
      state.pubkey = null;
      // ... (resto de la l√≥gica de handleDisconnection)
    }

    // Modificamos startAFK para que use el `wallet` del adapter
    async function startAFK(boosterType) {
        if (!wallet || !wallet.publicKey) {
            log('‚ùå Por favor, conecta tu wallet primero.');
            return;
        }
        // Usar `wallet.signTransaction` en lugar de `state.provider.signTransaction`
        const signedTransaction = await wallet.signTransaction(transaction);
        // ... (resto de la l√≥gica de la transacci√≥n)
    }

    // ... (el resto de tu c√≥digo de la app)
    
  </script>
</body>
</html>